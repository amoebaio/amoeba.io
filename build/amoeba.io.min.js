/*! amoeba.io 0.0.15 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("chaining-tool");ClientHolder=function(a,b){this.use=b,this.client=a,this.handlers_list={}},ClientHolder.prototype.handler=function(a,b){this.handlers_list[a]||(this.handlers_list[a]=[]),this.handlers_list[a].push(b)},ClientHolder.prototype.handlers=function(a){return this.handlers_list[a]||[]},ClientHolder.prototype.invoke=function(a){var b=this,c={request:{use:this.use,method:a},response:{error:null,result:null}},e=null;if(2==arguments.length)"function"==typeof arguments[1]?e=arguments[1]:c.request.params=arguments[1];else if(3==arguments.length)c.request.params=arguments[1],e=arguments[2];else if(arguments.length>3)throw new Error("More than 3 arguments received");var f=new d(b.handlers("before_invoke"));f.add(function(a,c){null!==e?b.client.invoke(a,function(b,d){a.response.error=b,a.response.result=d,c()}):(b.client.invoke(a),c())}),f.add(b.handlers("after_invoke")),f.start(c,function(a){null!==e&&e(a.response.error,a.response.result)},function(a){null!==e&&e(a.response.error,a.response.result)})},ClientHolder.prototype.on=function(a,b,c){this.client.on(this.use,a,b,c)},ClientHolder.prototype.removeListener=function(a,b,c){this.client.removeListener(this.use,a,b,c)},b.exports=c=ClientHolder},{"chaining-tool":3}],2:[function(a,b,c){var d=a("./amoeba-client-holder");Amoeba=function(){this.servers=[],this.objects={}},Amoeba.prototype.use=function(){if(1==arguments.length){if(this.objects[arguments[0]])return this.objects[arguments[0]];throw new Error("Service '"+arguments[0]+"' not found")}if(2==arguments.length){var a=new d(arguments[1],arguments[0]);return this.objects[arguments[0]]=a,a}},Amoeba.prototype.server=function(a){a.amoeba(this),this.servers.push(a)},b.exports=c=Amoeba},{"./amoeba-client-holder":1}],3:[function(a,b){b.exports=a("./lib/chain.js")},{"./lib/chain.js":4}],4:[function(a,b,c){var d=function(a){this.handlers=a||[],this.oncomplete=null,this.onbreak=null};d.prototype.add=function(a){if("function"==typeof a)this.handlers.push(a);else for(var b=0;b<a.length;b++)this.handlers.push(a[b])},d.prototype.start=function(a,b,c){this.oncomplete=b,this.onbreak=c,this.next(0,a)()},d.prototype.next=function(a,b){var c=this;return function(){0===arguments.length||1===arguments.length&&arguments[0]===!0?c.handlers[a]?c.handlers[a](b,c.next(a+1,b)):c.oncomplete(b):c.onbreak&&c.onbreak(b)}},b.exports=c=d},{}]},{},[1,2]);